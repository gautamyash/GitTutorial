<!DOCTYPE html>
<html>
  <head>
    <title>Booking Appointment App</title>
  </head>
  <body>
    <h1>Booking Appointment App</h1>
    <form id="bookingForm">
      <label for="name">Name:</label>
      <input type="text" id="name" name="name" required><br><br>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required><br><br>

      <button type="submit">Submit</button>
    </form>

    <h2>Bookings:</h2>
    <ul id="bookings"></ul>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      const form = document.getElementById('bookingForm');
      const bookingsList = document.getElementById('bookings');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;

        const res = await axios.post('https://crudcrud.com/api/be3606fc9cb644f69fdac9df5d85cc3b', { name, email });
        const booking = res.data;

        const li = document.createElement('li');
        li.innerHTML = `
          ${booking.name} (${booking.email})
          <button class="deleteButton" data-id="${booking._id}">Delete</button>
        `;
        bookingsList.appendChild(li);

        const deleteButtons = document.getElementsByClassName('deleteButton');
        for (let i = 0; i < deleteButtons.length; i++) {
          deleteButtons[i].addEventListener('click', async (e) => {
            const bookingId = e.target.getAttribute('data-id');
            await axios.delete(`https://crudcrud.com/api/be3606fc9cb644f69fdac9df5d85cc3b/${bookingId}`);
            li.remove();
          });
        }

        form.reset();
      });

      window.addEventListener('DOMContentLoaded', async () => {
        const res = await axios.get('https://crudcrud.com/api/be3606fc9cb644f69fdac9df5d85cc3b/bookings');
        const bookings = res.data;
        for (let booking of bookings) {
          const li = document.createElement('li');
          li.innerHTML = `
            ${booking.name} (${booking.email})
            <button class="deleteButton" data-id="${booking._id}">Delete</button>
          `;
          bookingsList.appendChild(li);
        }

        const deleteButtons = document.getElementsByClassName('deleteButton');
        for (let i = 0; i < deleteButtons.length; i++) {
          deleteButtons[i].addEventListener('click', async (e) => {
            const bookingId = e.target.getAttribute('data-id');
            await axios.delete(`https://crudcrud.com/api/be3606fc9cb644f69fdac9df5d85cc3b/bookings/${bookingId}`);
            e.target.parentElement.remove();
          });
        }
      });
    </script>
  </body>
</html>
